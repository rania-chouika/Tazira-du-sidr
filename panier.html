<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Votre Panier - Tazira</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    body {
      min-height: 100vh;
      margin: 0;
      font-family: 'Quicksand', 'Raleway', Arial, sans-serif;
      background: linear-gradient(120deg, #e2dbc2, #e5c335, #b6cfa5, #f6eec2, #e2dbc2);
      background-size: 300% 300%;
      animation: gradientMove 12s ease-in-out infinite;
    }
    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .main-panier {
      max-width: 540px;
      margin: 48px auto 0 auto;
      background: #fffbe6;
      border-radius: 22px;
      box-shadow: 0 8px 32px #e5c33555, 0 2px 8px #0001;
      padding: 2.5rem 2.2rem 2.2rem 2.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 340px;
      animation: popIn 0.7s cubic-bezier(.7,0,.3,1);
    }
    @keyframes popIn {
      0% { opacity: 0; transform: scale(0.7); }
      100% { opacity: 1; transform: scale(1); }
    }
    .titre-panier {
      font-size: 2rem;
      color: #7c9452;
      font-weight: 700;
      margin-bottom: 1.7rem;
      display: flex;
      align-items: center;
      gap: 0.7rem;
    }
    .titre-panier i {
      color: #e5c335;
      font-size: 1.5rem;
    }
    .liste-produits {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      margin-bottom: 2.2rem;
    }
    .carte-produit {
      display: flex;
      align-items: center;
      background: linear-gradient(120deg, #f6f6f6 60%, #e2dbc2 100%);
      border-radius: 14px;
      box-shadow: 0 2px 8px #e5c33522;
      padding: 1rem 1.2rem;
      gap: 1.2rem;
      animation: fadeInCart 0.7s;
      position: relative;
    }
    @keyframes fadeInCart {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .carte-img {
      width: 60px;
      height: 60px;
      border-radius: 10px;
      object-fit: cover;
      box-shadow: 0 2px 8px #e5c33533;
      background: #fff;
    }
    .carte-info {
      display: flex;
      flex-direction: column;
      flex: 1;
      gap: 0.2rem;
    }
    .carte-nom {
      font-size: 1.08rem;
      color: #50623A;
      font-weight: 600;
    }
    .carte-prix {
      font-size: 1rem;
      color: #e5c335;
      font-weight: 700;
    }
    .carte-qte {
      font-size: 0.98rem;
      color: #888;
      margin-left: 0.5rem;
    }
    .btn-supprimer {
      background: #e5c335;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.3rem 0.8rem;
      font-size: 0.98rem;
      font-weight: 700;
      margin-left: 1rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.18s;
      position: absolute;
      right: 1.2rem;
      top: 1.2rem;
    }
    .btn-supprimer:hover {
      background: #7c9452;
      color: #fff;
      box-shadow: 0 2px 8px #e5c33555;
      transform: scale(1.07);
    }
    .total-panier {
      font-size: 1.18rem;
      color: #7c9452;
      font-weight: 700;
      margin-bottom: 1.7rem;
      display: flex;
      align-items: center;
      gap: 0.7rem;
      justify-content: flex-end;
      width: 100%;
    }
    .btn-valider {
      background: linear-gradient(90deg, #e5c335 60%, #7c9452 100%);
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 0.9rem 2.2rem;
      font-size: 1.13rem;
      font-weight: 700;
      box-shadow: 0 2px 8px #e5c33533;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.18s;
      width: 100%;
      animation: btnPulse 1.2s infinite alternate;
    }
    @keyframes btnPulse {
      0% { box-shadow: 0 2px 8px #e5c33533; }
      100% { box-shadow: 0 8px 24px #e5c33577; }
    }
    .btn-valider:hover {
      background: linear-gradient(90deg, #7c9452 60%, #e5c335 100%);
      color: #fff;
      box-shadow: 0 4px 18px #e5c33555;
      transform: scale(1.07);
    }
    .panier-vide {
      text-align: center;
      color: #888;
      font-size: 1.15rem;
      margin: 2.5rem 0 1.5rem 0;
      animation: fadeInCart 0.7s;
    }
    .btn-ajouter-produit {
      background: #7c9452;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 0.7rem 1.7rem;
      font-size: 1.08rem;
      font-weight: 700;
      box-shadow: 0 2px 8px #e5c33533;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.18s;
      margin-top: 0.7rem;
    }
    .btn-ajouter-produit:hover {
      background: #e5c335;
      color: #7c9452;
      box-shadow: 0 4px 18px #e5c33555;
      transform: scale(1.07);
    }
    @media (max-width: 700px) {
      .main-panier { padding: 1.2rem 0.5rem; }
    }
    /* Ajout animation overlay validation */
    .validation-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(229, 195, 53, 0.18);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      transition: opacity 0.5s;
    }
    .validation-message {
      background: #fffbe6;
      border-radius: 18px;
      box-shadow: 0 4px 24px #e5c33555;
      padding: 2.2rem 3.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: popIn 0.7s cubic-bezier(.7,0,.3,1);
    }
    .validation-emoji {
      font-size: 3.2rem;
      animation: checkPulse 1.2s infinite alternate;
    }
    @keyframes checkPulse {
      0% { transform: scale(1); }
      100% { transform: scale(1.18); }
    }
    .validation-text {
      font-size: 1.3rem;
      color: #7c9452;
      font-weight: 700;
      margin-top: 1.1rem;
    }
    /* Carte 3D anim√©e */
    .card3D-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(80, 98, 58, 0.13);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1100;
    }
    .card3D-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.7rem;
    }
    .card3D {
      width: 340px;
      height: 210px;
      background: linear-gradient(120deg, #3a7bd5 60%, #00d2ff 100%);
      border-radius: 18px;
      box-shadow: 0 8px 32px #3a7bd555, 0 2px 8px #0001;
      position: relative;
      perspective: 800px;
      transform-style: preserve-3d;
      opacity: 1;
      overflow: hidden;
      /* Animation d'apparition personnalis√©e */
      animation: cardDropIn 1.1s cubic-bezier(.7,0,.3,1);
    }
    @keyframes cardDropIn {
      0% {
        opacity: 0;
        transform: translateY(-180px) rotateZ(-18deg) scale(0.7);
      }
      70% {
        opacity: 1;
        transform: translateY(10px) rotateZ(8deg) scale(1.04);
      }
      85% {
        transform: translateY(-8px) rotateZ(-6deg) scale(0.98);
      }
      100% {
        opacity: 1;
        transform: translateY(0) rotateZ(0deg) scale(1);
      }
    }
    .card3D-flotte {
      animation: cardFlotte 2.2s infinite alternate cubic-bezier(.7,0,.3,1);
    }
    @keyframes cardFlotte {
      0% { transform: translateY(0) rotateZ(0deg) scale(1); }
      100% { transform: translateY(-12px) rotateZ(3deg) scale(1.04); }
    }
    .card3D-front, .card3D-back {
      position: absolute;
      width: 100%; height: 100%;
      backface-visibility: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
      padding: 2.2rem 2.1rem 1.2rem 2.1rem;
    }
    .card3D-front { z-index: 2; }
    .cb-logo {
      font-size: 2.2rem;
      margin-bottom: 0.7rem;
    }
    .cb-chip {
      width: 38px; height: 28px;
      background: linear-gradient(90deg, #fffbe6 60%, #e5c335 100%);
      border-radius: 7px;
      margin-bottom: 1.1rem;
    }
    .cb-num {
      font-size: 1.18rem;
      color: #fff;
      letter-spacing: 0.13em;
      margin-bottom: 0.7rem;
      font-family: 'Courier New', monospace;
    }
    .cb-name {
      font-size: 1.1rem;
      color: #fff;
      font-weight: 700;
      margin-bottom: 0.5rem;
      letter-spacing: 0.12em;
    }
    .cb-exp {
      font-size: 0.98rem;
      color: #fffbe6;
      font-weight: 600;
    }
    .card3D-back {
      transform: rotateY(180deg);
      background: #2d3a4a;
      color: #fff;
      align-items: flex-end;
      padding-top: 2.5rem;
    }
    .cb-stripe {
      width: 100%; height: 28px;
      background: #222;
      margin-bottom: 1.2rem;
      border-radius: 4px;
    }
    .cb-cvv {
      font-size: 1.1rem;
      color: #fffbe6;
      font-weight: 600;
    }
    .btn-continuer {
      background: #7c9452;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 0.8rem 2.1rem;
      font-size: 1.08rem;
      font-weight: 700;
      box-shadow: 0 2px 8px #e5c33533;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.18s;
      margin-top: 0.7rem;
    }
    .btn-continuer:hover {
      background: #e5c335;
      color: #7c9452;
      box-shadow: 0 4px 18px #e5c33555;
      transform: scale(1.07);
    }
  </style>
</head>
<body>
  <div class="main-panier">
    <div class="titre-panier"><i class="fas fa-shopping-basket"></i>Votre Panier</div>
    <div class="liste-produits" id="listeProduits"></div>
    <div class="total-panier" id="totalPanier"></div>
    <button class="btn-valider" id="btnValider" onclick="validerPanier()">Valider le panier</button>
    <div class="panier-vide" id="panierVide" style="display:none;">
      <span style="font-size:2.2rem;display:block;">üß∫</span>
      Votre panier est vide.<br>
      <button class="btn-ajouter-produit" onclick="window.location.href='produits.html'">Ajouter des produits</button>
    </div>
  </div>
  <div id="validation-overlay" class="validation-overlay" style="display:none;">
    <div class="validation-message">
      <span class="validation-emoji">‚úîÔ∏è</span>
      <div class="validation-text">Panier valid√© !</div>
    </div>
  </div>
  <div id="card3D-overlay" class="card3D-overlay" style="display:none;">
    <div class="card3D-container">
      <div class="card3D" id="card3D">
        <div class="card3D-front">
          <div class="cb-logo">üí≥</div>
          <div class="cb-chip"></div>
          <div class="cb-num">4321 1234 5678 9876</div>
          <div class="cb-name">TAZIRA</div>
          <div class="cb-exp">12/28</div>
        </div>
        <div class="card3D-back">
          <div class="cb-stripe"></div>
          <div class="cb-cvv">CVV: <span>123</span></div>
        </div>
      </div>
      <button class="btn-continuer" onclick="goToPaiement()">Continuer vers paiement & livraison</button>
    </div>
  </div>
  <script>
    // Charger le panier depuis le localStorage, ou tableau vide si rien
    let panier = JSON.parse(localStorage.getItem('cart')) || [];

    function renderPanier() {
      const liste = document.getElementById('listeProduits');
      const totalDiv = document.getElementById('totalPanier');
      const btnValider = document.getElementById('btnValider');
      const panierVide = document.getElementById('panierVide');
      liste.innerHTML = '';
      let total = 0;
      if (panier.length === 0) {
        liste.style.display = 'none';
        totalDiv.style.display = 'none';
        btnValider.style.display = 'none';
        panierVide.style.display = 'block';
      } else {
        liste.style.display = 'flex';
        totalDiv.style.display = 'flex';
        btnValider.style.display = 'block';
        panierVide.style.display = 'none';
        panier.forEach((p, idx) => {
          total += p.price * p.qty;
          let imageHtml = '';
          if (p.img) {
            imageHtml = `<img src='produits images/${p.img}' class='carte-img' alt='${p.name}'>`;
          }
          liste.innerHTML += `
            <div class='carte-produit'>
              ${imageHtml}
              <div class='carte-info'>
                <span class='carte-nom'>${p.name}</span>
                <span class='carte-prix'>${p.price} MAD</span>
                <span class='carte-qte'>x${p.qty}</span>
              </div>
              <button class='btn-supprimer' onclick='supprimerProduit(${idx})'>Supprimer</button>
            </div>`;
        });
        totalDiv.innerHTML = `<i class='fas fa-coins' style='color:#e5c335;'></i> Total : <span>${total} MAD</span>`;
      }
    }
    function supprimerProduit(idx) {
      panier.splice(idx, 1);
      localStorage.setItem('cart', JSON.stringify(panier));
      renderPanier();
    }
    function validerPanier() {
      // Animation overlay validation
      const overlay = document.getElementById('validation-overlay');
      overlay.style.display = 'flex';
      overlay.style.opacity = '0';
      overlay.style.transition = 'opacity 0.5s';
      setTimeout(() => {
        overlay.style.opacity = '1';
      }, 10);
      setTimeout(() => {
        overlay.style.opacity = '0';
        setTimeout(() => {
          overlay.style.display = 'none';
          showCard3D();
        }, 500);
      }, 1500);
    }
    function showCard3D() {
      // Animation carte 3D : apparition du haut, rotation, puis flottement
      const overlay = document.getElementById('card3D-overlay');
      overlay.style.display = 'flex';
      const card = document.getElementById('card3D');
      card.classList.remove('card3D-flotte');
      card.style.animation = 'cardDropIn 1.1s cubic-bezier(.7,0,.3,1)';
      setTimeout(() => {
        card.style.animation = '';
        card.classList.add('card3D-flotte');
      }, 1100);
    }
    function goToPaiement() {
      window.location.href = 'paiement.html';
    }
    window.onload = renderPanier;
  </script>
</body>
</html>